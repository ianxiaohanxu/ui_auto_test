*** Settings ***
Documentation     操作U帐户加钱减钱
...
...               type列表
...               * 0) U币账户升级迁移(原来的分钟数-->U)
...               * 1) U币账户升级补齐赠送 当天新注册用户赠送50U币 个性化赠送
...               * 2) 应用外push赠送 个性化赠送
...               * 3) 主动打开app赠送 个性化赠送
...               * 4) 邀请好友奖励 每成功邀请一位用户，奖励20U，邀请好友奖励不能超过赠送上限（邀请好友奖励按自然月累计，每个月重新计数）
...               * 5) 分享奖励 每成功分享到朋友圈，QQ空间，新浪微博，奖励5U，每30天仅一次（现有策略不改动）
...               * 6) 新手大礼包
...               * 7) 会员OTT电话返还
...               * 8) U币购买
...               * 9) 国内电话消耗
...               * 10)国际电话消耗
...               * 11)聊一聊消耗
...               * 12)购买会员赠送
...               * 13)当天新注册用户赠送50U币 个性化赠送
...               * 14)兑吧
...               * 15)制卡
...               * 16) U币退货
...               * 17) 触达
...               * 18) 花椒兑换
...               * 19) 市场活动(php)
...               * 20) 个性化购买
Library    ../../../../resources/uxin_request.py
Library    ../../../../resources/tools_library.py                      
Resource    ../../../../Resources/check_operation.txt
Resource    ../../../../Resources/db_operation.txt                      
Variables   ../../../../Resources/global_config.py
Variables   ../../../../Resources/interface_data.py 

*** Test Cases ***
operateU_type3_successs
    [Tags]    hotto    normal    P0    offline
    #初始化数据
    ${tradeTime}=   get time
    ${order}=    get time    epoch       
    ${params}=    create dictionary    uid=${normal_uid}    u=1    base=0  tradeTime=${tradeTime}  appkey=order    type=3  bussinessId=order${order+2}   pv=android  v=5.1.0    callType=    calledUid=  tradeMoney=
    #查询数据库起始数据
    ${db}=    get_bc_db    ${normal_uid}
    ${table}=    evaluate    ${normal_uid}%100
    ${bclog}=    db_pymysql_query    select ubalance from ${db}.balance_${table} where uid = ${normal_uid}    ${db_url}
    ${u}=    evaluate    ${bclog[0][0]}/100000    
    #调用接口
    ${resp}=    get_general    ${das_url}    operateForU    params=${params}
    #校验
    ${content}=    utf_to_unicode    ${resp.content}
    Should Contain    ${content}    "result":0
    should contain many     ${content}     base    logId    "u":${u+1}    ucashValue
    #todo 检验ucash

operateU_type4_successs
    [Tags]    hotto    normal    P1    offline
    #初始化数据
    ${tradeTime}=   get time
    ${order}=    get time    epoch       
    ${params}=    create dictionary    uid=${normal_uid}    u=20    base=0  tradeTime=${tradeTime}  appkey=order    type=4  bussinessId=order${order+3}   pv=android  v=5.1.0    callType=    calledUid=  tradeMoney=
    #查询数据库起始数据
    ${db}=    get_bc_db    ${normal_uid}
    ${table}=    evaluate    ${normal_uid}%100
    ${bclog}=    db_pymysql_query    select ubalance from ${db}.balance_${table} where uid = ${normal_uid}    ${db_url}
    ${u}=    evaluate    ${bclog[0][0]}/100000    
    #调用接口
    ${resp}=    get_general    ${das_url}    operateForU    params=${params}
    #校验
    ${content}=    utf_to_unicode    ${resp.content}
    Should Contain    ${content}    "result":0
    should contain many     ${content}     base    logId    "u":${u+20}    ucashValue

operateU_type5_successs
    [Tags]    hotto    normal    P1    offline
    #初始化数据
    ${tradeTime}=   get time
    ${order}=    get time    epoch       
    ${params}=    create dictionary    uid=${normal_uid}    u=5    base=0  tradeTime=${tradeTime}  appkey=order    type=5  bussinessId=order${order+4}   pv=android  v=5.1.0    callType=    calledUid=  tradeMoney=
    #查询数据库起始数据
    ${db}=    get_bc_db    ${normal_uid}
    ${table}=    evaluate    ${normal_uid}%100
    ${bclog}=    db_pymysql_query    select ubalance from ${db}.balance_${table} where uid = ${normal_uid}    ${db_url}
    ${u}=    evaluate    ${bclog[0][0]}/100000    
    #调用接口
    ${resp}=    get_general    ${das_url}    operateForU    params=${params}
    #校验
    ${content}=    utf_to_unicode    ${resp.content}
    Should Contain    ${content}    "result":0
    should contain many     ${content}     base    logId    "u":${u+5}    ucashValue

operateU_type6_successs
    [Tags]    hotto    normal    P1    offline
    #初始化数据
    ${tradeTime}=   get time
    ${order}=    get time    epoch       
    ${params}=    create dictionary    uid=${normal_uid}    u=120    base=0  tradeTime=${tradeTime}  appkey=order    type=6  bussinessId=order${order+5}   pv=android  v=5.1.0    callType=    calledUid=  tradeMoney=
    #查询数据库起始数据
    ${db}=    get_bc_db    ${normal_uid}
    ${table}=    evaluate    ${normal_uid}%100
    ${bclog}=    db_pymysql_query    select ubalance from ${db}.balance_${table} where uid = ${normal_uid}    ${db_url}
    ${u}=    evaluate    ${bclog[0][0]}/100000    
    #调用接口
    ${resp}=    get_general    ${das_url}    operateForU    params=${params}
    #校验
    ${content}=    utf_to_unicode    ${resp.content}
    Should Contain    ${content}    "result":0
    should contain many     ${content}     base    logId    "u":${u+120}    ucashValue

operateU_parameters_error
    [Tags]    hotto    normal    P0    offline
    #初始化数据
    ${tradeTime}=   get time
    ${order}=    get time    epoch       
    ${params}=    create dictionary    uid=${normal_uid}    u=120    base=0  tradeTime=${tradeTime}  appkey=order    type=6  bussinessId=order${order+5}   pv=android  v=5.1.0    callType=    calledUid=  tradeMoney=  
    #调用接口
    ${resp}=    get_general    ${das_url}    operateForU    params=${params}
    #校验
    ${content}=    utf_to_unicode    ${resp.content}
    Should Contain    ${content}    "result":0
