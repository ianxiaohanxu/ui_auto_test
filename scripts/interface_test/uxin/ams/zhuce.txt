*** Settings ***
Documentation     验证码登录
Library           ../../../../Resources/uxin_request.py
Library           ../../../../Resources/tools_library.py
Resource          ../../../../Resources/check_operation.txt
Resource          ../../../../Resources/uxin_tools.txt
Variables         ../../../../Resources/global_config.py
Variables         ../../../../Resources/interface_data.py

*** Test Cases ***
authcodelogin_success
    [Documentation]    验证码登录成功
    [Tags]    test    
    #初始化数据
    @{time}=    get time    year month day hour
    #因为每天下发短信总数有限制，先清短信上限缓存，再发送验证码
    ${account}    set variable    11919871153
    #clear_accache    ${account}
    #发送验证码
    send_ac    ${account}
    ${authcode}=    get_login_ac    ${account}
    ${params}=    create dictionary    phone=${account}    authcode=${authcode}    ip=121.35.100.168    imei=02:00:00:00:00:00    pv=android    invitedby=4852    invitedflag=0    v=5.5.0    ext=android|5.5.0|0    from=mobile
    #调用接口
    ${resp}=    get_general    ${ams_url}    authcodeloginreg.act    params=${params}
    #获取数据库的登录记录
    #${login_log}=    get_login_log    ${account}
    #${login_log}=    convert to string    ${login_log}
    #校验
    Should Contain    ${resp.content}    "result": 0
    #should Contain many    ${login_log}        iphone    5.3.0    ${time[0]}    ${time[2]}    ${time[3]}    
    should contain many    ${resp.content}    "ssid"      im_ssid