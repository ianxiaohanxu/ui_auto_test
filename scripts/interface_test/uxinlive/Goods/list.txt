*** Settings ***
Library           ../../../../Resources/uxin_request.py
Library           ../../../../Resources/uxin_live.py
Library           ../../../../Resources/tools_library.py
Variables         ../../../../Resources/global_config.py
Resource          ../../../../Resources/db_operation.txt
Resource          ../../../../Resources/check_operation.txt
Library           ../../../../Resources/redis_library.py
Library           ../../../../Resources/Jsonto.py

*** Test Cases ***
query_charge_list_success
    [Tags]    normal
    #初始化数据
    ${ac}=    get_token    1352245789
    ${random1}=    Randomqq
    ${random2}=    Randomqq
    ${random3}=    Randomqq
    ${random4}=    Randomqq
    ${random5}=    Randomqq
    ${datas1}=    Set Variable    name=candy${random1}&typeId=1&price=10&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark1
    ${datas2}=    Set Variable    name=candy${random2}&typeId=2&price=11&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark2
    ${datas3}=    Set Variable    name=candy${random3}&typeId=1&price=12&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark3
    ${datas4}=    Set Variable    name=candy${random4}&typeId=2&price=13&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark4
    ${datas5}=    Set Variable    name=candy${random5}&typeId=1&price=14&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark5
    ${files}=    Set Variable    pic=@${CURDIR}/1.png
    ${content1}=    upload_file    ${ac}    params=${datas1}    files=${files}    url=goods/create
    ${content2}=    upload_file    ${ac}    params=${datas2}    files=${files}    url=goods/create
    ${content3}=    upload_file    ${ac}    params=${datas3}    files=${files}    url=goods/create
    ${content4}=    upload_file    ${ac}    params=${datas4}    files=${files}    url=goods/create
    ${content5}=    upload_file    ${ac}    params=${datas5}    files=${files}    url=goods/create
    ${content1}=    utf_to_unicode    ${content1}
    ${content2}=    utf_to_unicode    ${content2}
    ${content3}=    utf_to_unicode    ${content3}
    ${content4}=    utf_to_unicode    ${content4}
    ${content5}=    utf_to_unicode    ${content5}
    ${goods_id1}=    get_from_jsonObject    ${content1}    /b/id
    ${goods_id2}=    get_from_jsonObject    ${content2}    /b/id
    ${goods_id3}=    get_from_jsonObject    ${content3}    /b/id
    ${goods_id4}=    get_from_jsonObject    ${content4}    /b/id
    ${goods_id5}=    get_from_jsonObject    ${content5}    /b/id
    ${goods_pic1}=    get_from_jsonObject    ${content1}    /b/pic
    ${goods_pic2}=    get_from_jsonObject    ${content2}    /b/pic
    ${goods_pic3}=    get_from_jsonObject    ${content3}    /b/pic
    ${goods_pic4}=    get_from_jsonObject    ${content4}    /b/pic
    ${goods_pic5}=    get_from_jsonObject    ${content5}    /b/pic
    #下架第三个商品
    ${datas}=    Set Variable    typeId=1&id=${goods_id3}&status=2
    ${files}=    Set Variable    pic=@${CURDIR}/2.png
    ${content}=    upload_file    ${ac}    params=${datas}    files=${files}    url=goods/update
    #调用查询商品列表接口
    ${headers}=    Set Variable    ${ac};_c=1
    ${datas}=    create dictionary    typeId=1
    ${resp}=    get_general    ${live_goods_url}    list    headers=${headers}    params=${datas}
    ${content}=    utf_to_unicode    ${resp.content}
    #打印结果，用于调试
    log    ${content}
    should contain many    ${content}    {"id":${goods_id1},"name":"candy${random1}","typeId":1,"price":10.0,"discount":8.8,"discountDesc":"boom","golds":1000,"addGolds":9,"addGoldsDesc":"GoldsDesc","pic":"${goods_pic1}","status":1,"remark":"testmark1"}
    should contain many    ${content}    {"id":${goods_id5},"name":"candy${random5}","typeId":1,"price":14.0,"discount":8.8,"discountDesc":"boom","golds":1000,"addGolds":9,"addGoldsDesc":"GoldsDesc","pic":"${goods_pic5}","status":1,"remark":"testmark5"}
    Should Not Contain    ${content}    "id":${goods_id2},"name":"candy${random2}"
    Should Not Contain    ${content}    "id":${goods_id3},"name":"candy${random3}"
    Should Not Contain    ${content}    "id":${goods_id4},"name":"candy${random4}"

query_gift_list_success
    [Tags]    normal
    #初始化数据
    ${ac}=    get_token    1352245790
    ${random1}=    Randomqq
    ${random2}=    Randomqq
    ${random3}=    Randomqq
    ${random4}=    Randomqq
    ${random5}=    Randomqq
    ${datas1}=    Set Variable    name=candy${random1}&typeId=2&price=10&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark1
    ${datas2}=    Set Variable    name=candy${random2}&typeId=1&price=11&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark2
    ${datas3}=    Set Variable    name=candy${random3}&typeId=2&price=12&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark3
    ${datas4}=    Set Variable    name=candy${random4}&typeId=1&price=13&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark4
    ${datas5}=    Set Variable    name=candy${random5}&typeId=2&price=14&discount=8.8&discountDesc=boom&golds=1000&addGolds=9&addGoldsDesc=GoldsDesc&remark=testmark5
    ${files}=    Set Variable    pic=@${CURDIR}/1.png
    ${content1}=    upload_file    ${ac}    params=${datas1}    files=${files}    url=goods/create
    ${content2}=    upload_file    ${ac}    params=${datas2}    files=${files}    url=goods/create
    ${content3}=    upload_file    ${ac}    params=${datas3}    files=${files}    url=goods/create
    ${content4}=    upload_file    ${ac}    params=${datas4}    files=${files}    url=goods/create
    ${content5}=    upload_file    ${ac}    params=${datas5}    files=${files}    url=goods/create
    ${content1}=    utf_to_unicode    ${content1}
    ${content2}=    utf_to_unicode    ${content2}
    ${content3}=    utf_to_unicode    ${content3}
    ${content4}=    utf_to_unicode    ${content4}
    ${content5}=    utf_to_unicode    ${content5}
    ${goods_id1}=    get_from_jsonObject    ${content1}    /b/id
    ${goods_id2}=    get_from_jsonObject    ${content2}    /b/id
    ${goods_id3}=    get_from_jsonObject    ${content3}    /b/id
    ${goods_id4}=    get_from_jsonObject    ${content4}    /b/id
    ${goods_id5}=    get_from_jsonObject    ${content5}    /b/id
    ${goods_pic1}=    get_from_jsonObject    ${content1}    /b/pic
    ${goods_pic2}=    get_from_jsonObject    ${content2}    /b/pic
    ${goods_pic3}=    get_from_jsonObject    ${content3}    /b/pic
    ${goods_pic4}=    get_from_jsonObject    ${content4}    /b/pic
    ${goods_pic5}=    get_from_jsonObject    ${content5}    /b/pic
    #下架第三个商品
    ${datas}=    Set Variable    typeId=2&id=${goods_id3}&status=2
    ${files}=    Set Variable    pic=@${CURDIR}/2.png
    ${content}=    upload_file    ${ac}    params=${datas}    files=${files}    url=goods/update
    #调用查询商品列表接口
    ${headers}=    Set Variable    ${ac};_c=1
    ${datas}=    create dictionary    typeId=2
    ${resp}=    get_general    ${live_goods_url}    list    headers=${headers}    params=${datas}
    ${content}=    utf_to_unicode    ${resp.content}
    #打印结果，用于调试
    log    ${content}
    should contain many    ${content}    {"id":${goods_id1},"name":"candy${random1}","typeId":2,"price":10.0,"discount":8.8,"discountDesc":"boom","golds":1000,"addGolds":9,"addGoldsDesc":"GoldsDesc","pic":"${goods_pic1}","status":1,"remark":"testmark1"}
    should contain many    ${content}    {"id":${goods_id5},"name":"candy${random5}","typeId":2,"price":14.0,"discount":8.8,"discountDesc":"boom","golds":1000,"addGolds":9,"addGoldsDesc":"GoldsDesc","pic":"${goods_pic5}","status":1,"remark":"testmark5"}
    Should Not Contain    ${content}    "id":${goods_id2},"name":"candy${random2}"
    Should Not Contain    ${content}    "id":${goods_id3},"name":"candy${random3}"
    Should Not Contain    ${content}    "id":${goods_id4},"name":"candy${random4}"
